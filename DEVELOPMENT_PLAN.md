# 画像閲覧アプリケーション開発計画

## プロジェクト概要
Windowsデスクトップ向けの同人誌画像管理アプリケーション。特定のWebサイトから画像をクローリングして、ローカルで管理・閲覧する機能を提供する。

## 技術スタック
- **フロントエンド**: Electron + React (TypeScript)
- **クローリング**: Node.js (Puppeteer or Playwright)
- **データ管理**: ファイルシステム + JSONメタデータ（データベース不使用）
- **テスト**: Playwright (E2E)

## 想定規模
- 同人誌数: 数百作品
- 1作品あたりの画像数: 約100枚以下
- 総画像数: 数万枚

## データ構造
```
/library/
  /[作品ID]_[作品名]/
    /images/
      001.jpg
      002.jpg
      ...
    metadata.json
```

### metadata.json の構造
```json
{
  "id": "unique-id",
  "title": "作品名",
  "url": "取得元URL",
  "tags": ["タグ1", "タグ2"],
  "createdAt": "2024-01-01T00:00:00Z",
  "imageCount": 100
}
```

## プロジェクト構造
```
image-viewer/
├── src/
│   ├── main/           # Electronメインプロセス
│   │   ├── index.ts
│   │   └── crawler/    # クローリングロジック
│   ├── renderer/       # レンダラープロセス (React)
│   │   ├── App.tsx
│   │   ├── components/
│   │   │   ├── FolderTree.tsx
│   │   │   ├── ImageGrid.tsx
│   │   │   └── TagManager.tsx
│   │   └── hooks/      # カスタムフック
│   └── shared/         # 共通の型定義など
├── library/            # 画像データ保存先
├── tests/
│   └── e2e/           # Playwrightテスト
└── package.json
```

## UI/UX設計
- **メイン画面**: フォルダツリー + 画像一覧（エクスプローラー風）
- **レイアウト**:
  ```
  [メニューバー]
  [ツールバー: 新規取得 | タグ管理 | 検索 | 表示切替]
  [==========================================]
  [フォルダツリー] | [画像一覧/グリッド表示]
  [  作品一覧    ] | [サムネイル表示        ]
  [  - 作品A     ] | [詳細パネル            ]
  [  - 作品B     ] | [  タグ: []            ]
  [==========================================]
  [ステータスバー: 選択中の作品情報]
  ```

## 機能一覧（優先度別）

### 優先度：高（コア機能）
1. **クローリング機能**
   - URL入力による画像一括取得
   - ページ内リンクを辿っての画像収集
   - 進捗表示とキャンセル機能

2. **基本的な画像管理**
   - フォルダツリーによる作品管理
   - 画像一覧表示（エクスプローラー風）
   - 高速な画像表示（サムネイルキャッシュ）

3. **タグ機能**
   - 作品単位での手動タグ付け
   - タグによる検索・フィルタリング

### 優先度：中
- 重複画像チェック
- エラー時のリトライ機能
- 画像の遅延読み込み
- タグの一括編集

### 優先度：低
- セキュリティ機能（パスワードロック等）
- エクスポート機能（ZIP/PDF）
- 読書履歴
- お気に入り機能

## 開発フェーズ

### フェーズ1: 基本セットアップ（MVP）
1. Electron + React + TypeScriptの初期設定
2. 基本的なウィンドウとメニューの作成
3. プロジェクト構造の構築
4. シンプルなクローリング機能
5. 画像の保存と一覧表示
6. フォルダツリー実装

### フェーズ2: タグ機能と検索
1. タグ付けUIの実装
2. メタデータ管理システム
3. タグによる検索・フィルタリング機能
4. サムネイル生成と高速表示

### フェーズ3: テストと最適化
1. PlaywrightでのE2Eテスト実装
2. パフォーマンス最適化
3. UI/UXの改善
4. エラーハンドリングの強化

## クローリング仕様
- **対象**: 特定のWebサイト
- **方式**: URLを入力し、そのページ内のリンク先にある画像を取得
- **考慮事項**:
  - 利用規約とrobots.txtの遵守
  - レート制限（アクセス頻度の制御）
  - 著作権への配慮

## パフォーマンス最適化
- サムネイルのキャッシュ生成
- 遅延読み込み（表示領域の画像のみロード）
- プリロード（次の画像を先読み）

## 今後の拡張可能性
- クロスプラットフォーム対応（Mac/Linux）
- クラウドストレージ連携
- AI による自動タグ付け
- 画像編集機能